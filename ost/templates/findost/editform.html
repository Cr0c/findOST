<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<script type="text/javascript" src="/static/jquery.js"></script>
		<script type="text/javascript" src="/static/application.js"></script>
		<link rel="stylesheet" media="screen" type="text/css" title="Design" href="/static/style.css" />
		<title>FindOST.com | Edit</title>
	</head>
	<body>
		<header>
			<a href='/home'><div id='header' class='center'></div></a>
		</header>
		
		
		<nav>
			<div id='menu'>
				<ul>
					<li>{{message}}</li>
					{% if isauth %}
					<li><a href="/logout">Log out</a></li>
					{% else %}
					<li><a href="#" onclick='showlogin()'>Log in</a><div id="loginform"></div></li>
					<li><a href="/showsubscribe">New User</a></li>
					{% endif %}
				</ul>
			</div>
		</nav>
		
		
		<h2>Edit Information</h2>
		<br/>
		<form action='save' name="edit" id="edit" method="post">
			{% csrf_token %}
			
			{% if obj.show.title %}
			<p>
				Show : {{obj.show.title}}
				<div>season : {{obj.seasonnb}}, episode : {{obj.number}}</div>
			</p>		
			{% endif %}
			
			<label for="title">Title</label>
			<input name="title" id="title" type="text" value="{{obj.title}}" required />
			
			<br/>
			
			
			<label for="otitle">Original Title</label>
			{% if obj.otitle %}
			<input name="otitle" id="otitle" type="text" value="{{obj.otitle}}" />
			{% else %}
			<input name="otitle" id="otitle" type="text" />			
			{% endif %}
			
			<br/>
			
			<label for="director">Director</label>
			{% if obj.director %}
			<input name="director" id="director" type="text" value="{{obj.director}}" />
			{% else %}
			<input name="director" id="director" type="text" />			
			{% endif %}
						
			<br/>
			
			{% if not obj.show %}
				<label for="producer">Producer</label>
				{% if obj.director %}
				<input name="producer" id="producer" type="text" value="{{obj.producer}}" />
				{% else %}
				<input name="producer" id="producer" type="text" />			
				{% endif %}
			{% endif %}			
			<br/>
			
			{% if not obj.show %}
				<label for="composer">Original Music Composer</label>
				{% if obj.director %}
				<input name="composer" id="composer" type="text" value="{{obj.composer}}" />
				{% else %}
				<input name="composer" id="composer" type="text" />			
				{% endif %}
			{% endif %}			
			<br/>
			
				<label for="imageurl">Image URL</label>
			{% if obj.show %}
				{% if obj.show.imageurl %}
				<input name="imageurl" id="imageurl" type="text" value="{{obj.show.imageurl}}" />
				{% else %}
				<input name="imageurl" id="imageurl" type="text" />			
				{% endif %}
			{% else %}	
				{% if obj.imageurl %}
				<input name="imageurl" id="imageurl" type="text" value="{{obj.imageurl}}" />
				{% else %}
				<input name="imageurl" id="imageurl" type="text" />			
				{% endif %}
			{% endif %}			
			<br/>
			
			
			<div id="actors">
			<p>Actors</p>
	
				<div class="actor">
					<input name="actor1" id="actor1" type="text"/>
				</div>
			</div>
			
			<br/>
			
			<div id="songs">
			<p>Songs</p>
				<div class="song">
					<input name="songtitle1" id="songtitle1" type="text"/><span>by</span><input name="songartist1" id="songartist1" type="text"/>
				</div>
			</div>
			
			<br/>
			
			<div>
			<input type='submit' value='Save Changes'/>
			</div>
		</form>
		
		<div id='temp' style='visibility:hidden;'></div>
		<div id='temp2' style='visibility:hidden;'></div>		
		<script>
			function fillSong(title,artist){
				$('.song').children().last().val(artist);
				$('.song').children().last().siblings('input').last().val(title);
						
					
				}
			function fillActor(actor){
				$('.actor').children().last().val(actor);	
			}
				
			$(document).ready(function() {

				$("#actors").autoAddingTextFields("actor");
				$("#songs").autoAddingTextFields("song");
				
				{% for actor in obj.mainactors.all%}
					$('#temp').html("{{actor.name}}");
					fillActor($('#temp').html());
					$('.actor').children().last().trigger('input');
				{% endfor %}
				{% for actor in obj.show.mainactors.all%}
					$('#temp').html("{{actor.name}}");
					fillActor($('#temp').html());
					$('.actor').children().last().trigger('input');
				{% endfor %}
				
				{% for song in obj.songs.all %}
					$('#temp').html("{{song.title}}");
					$('#temp2').html("{{song.artist.name}}");					
					
					
					var title = $('#temp').html();
					var artist = $('#temp2').html();
					fillSong(title,artist);
					$('.song').children().last().trigger('input');
				{% endfor %}
				
				$('#temp').html('');
				$('#temp2').html('');
			}); 
		</script>
	
	</body>
</html>
